<!DOCTYPE HTML>
<!--
	Eventually by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
	<title>System Signal Records</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="assets/css/main.css" />
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/typeahead.js/0.10.4/typeahead.bundle.min.js"></script>
	<script src="EliteDangerousRegionMap/RegionMap.js"></script>
	<script src="pretty-print-json.js"></script>
	<link href="css/pretty-print-json.css" type="text/css" rel="stylesheet" />
	<link href="css/typeahead.css" type="text/css" rel="stylesheet" />
	<link href="https://unpkg.com/tabulator-tables@4.3.0/dist/css/tabulator_midnight.min.css" rel="stylesheet">
	<script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.3.0/dist/js/tabulator.min.js"></script>
</head>

<body class="is-preload">

	<!-- Header -->
	<header id="header">
		<h1>System Signals</h1>
		<p>Enter a system name to view signals recorded by Canonn field researchers</p>
	</header>


	<script src="https://code.highcharts.com/highcharts.js"></script>
	<script src="https://code.highcharts.com/modules/exporting.js"></script>
	<script src="https://code.highcharts.com/modules/export-data.js"></script>
	<script src="https://code.highcharts.com/modules/accessibility.js"></script>
	<script src="https://code.highcharts.com/highcharts-more.js"></script>





	<!-- Signup Form -->
	<script>

		var signals = {}
		var entries = {}

		var getParams = function (url) {
			var params = {};
			var parser = document.createElement('a');
			parser.href = url;
			var query = parser.search.substring(1);
			var vars = query.split('&');
			for (var i = 0; i < vars.length; i++) {
				var pair = vars[i].split('=');
				params[pair[0]] = decodeURIComponent(pair[1]);
			}
			return params;
		};

		var params = getParams(window.location.href);

		$(document).ready(function () {
			if (params.system) {
				//$(#form).submitForm();


				var system = decodeURIComponent(params.system).replace(/\+/g, " ")

				doDisplay(system);

				$("#system").val(system);

			}

		});




		function updateSignals(json) {
			//console.log(json);
			window.signals = json.signals

			var table = new Tabulator("#results-table", {
				data: json.signals,           //load row data from array
				layout: "fitColumns",      //fit columns to width of table
				responsiveLayout: "hide",  //hide columns that dont fit on the table
				tooltips: true,            //show tool tips on cells
				addRowPos: "top",          //when adding a new row, add it to the top of the table
				pagination: "local",       //paginate the data
				paginationSize: 50,         //allow 7 rows per page of data
				movableColumns: true,      //allow column order to be changed
				resizableRows: true,       //allow row order to be changed

				columns: [                 //define the table columns

					{ title: "Body", field: "body", headerFilter: true },
					{ title: "Signal Type", field: "type", headerFilter: true },
					{ title: "Signal Count", field: "count", headerFilter: true },
				],
			});
		}
		function updateEntries(json) {
			window.entries = json.signals

			var table = new Tabulator("#entries-table", {
				data: json.signals,           //load row data from array
				layout: "fitColumns",      //fit columns to width of table
				responsiveLayout: "hide",  //hide columns that dont fit on the table
				tooltips: true,            //show tool tips on cells
				addRowPos: "top",          //when adding a new row, add it to the top of the table
				pagination: "local",       //paginate the data
				paginationSize: 50,         //allow 7 rows per page of data
				movableColumns: true,      //allow column order to be changed
				resizableRows: true,       //allow row order to be changed

				columns: [                 //define the table columns

					{ title: "Body", field: "body", headerFilter: true },
					{ title: "Signal#", field: "id", headerFilter: true },
					{ title: "Category", field: "hud_category", headerFilter: true },
					{ title: "Species", field: "english_name", headerFilter: true },
				],

			});
		}

		function doDisplay(system) {
			getSignalEntries(system)
			getSignals(system)
			getBodies(system)
		}

		function getSignalEntries(system) {
			$("#result").text("Searching")

			fetch(encodeURI('https://us-central1-canonn-api-236217.cloudfunctions.net/getSignalEntries?system=' + system))
				.then(response => response.json())
				.then(json => updateEntries(json))
				;
		}
		function getSignals(system) {
			$("#result").text("Searching")

			fetch(encodeURI('https://us-central1-canonn-api-236217.cloudfunctions.net/getSignals?system=' + system))
				.then(response => response.json())
				.then(json => updateSignals(json))
				;
		}
		function getBodies(system) {
			fetch(encodeURI('https://www.edsm.net/api-system-v1/bodies?systemName=' + system))
				.then(response => response.json())
				.then(json => updateChart(json))
				;
		}

		function submitform() {
			var data = $(this).serializeArray();
			doDecode($('input:text').val(), $("#data").val());
			return false;
		};
	</script>
	<div>
		<form id="form" method="GET">
			<div id="search-container">
				<input type="text" placeholder="System Name eg. Merope" name="system" id="system" class="typeahead"
					style="z-index: 10;">
			</div>
			<input type="submit">
		</form>

		</p>

		<script>
			function updateChart(edsm) {
				Array.prototype.unique = function () {
					var a = this.concat();
					for (var i = 0; i < a.length; ++i) {
						for (var j = i + 1; j < a.length; ++j) {
							if (a[i] === a[j])
								a.splice(j--, 1);
						}
					}

					return a;
				};

				$(".highcharts-description").text(`
			This chart shows the range of gravity and temperature of each of the different classes of biology, represented by rectangles.
			There are seperate ranges for each body type therefore some biology classes will have multiple rectangles one foreach body type.
			`)

				var opacity = 0.1;
				var primary = 'Unknown'
				var system = edsm.name
				var regiondata = findRegionForBoxel(edsm.id64)
				var region = regiondata.region.id
				var regionname = regiondata.region.name
				//console.log(region)


				planets = []

				bodies = edsm.bodies
				bodies.forEach((body, i, a) => {
					if (body.type == "Star" & body.isMainStar) {
						primary = body.subType
					}
					if (body.type == 'Planet' & body.isLandable) {
						planet = body.name.replace(system, '');
						bodyType = body.subType
						planets.push(
							{
								name: 'Planet' + planet + ' - (' + bodyType + ')',
								color: 'black',
								marker: { symbol: 'circle' },
								showInLegend: false,
								data: [[body.surfaceTemperature, body.gravity]],
								bodyType: bodyType,
								volcanism: body.volcanismType
							}
						);
					}
				});

				var biostats = [
					{ name: 'Prasinum Bioluminescent Anemone (Metal-rich body)', type: 'polygon', data: [[1009.0, 0.03], [3042.0, 0.03], [3042.0, 11.01], [1009.0, 11.01]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'Metal-rich body', stars: ["O (Blue-White) Star", "Herbig Ae/Be Star"], regions: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 18, 19, 20, 24, 30, 31, 33, 34, 35, 36], volcanism: 'N' },
					{ name: 'Roseum Bioluminescent Anemone (Metal-rich body)', type: 'polygon', data: [[1001.0, 0.04], [4527.0, 0.04], [4527.0, 4.51], [1001.0, 4.51]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'Metal-rich body', stars: ["B (Blue-White) Star", "B (Blue-White super giant) Star"], regions: [1, 2, 3, 4, 5, 7, 9, 18, 24, 25, 29, 31, 33, 34, 35, 36, 39, 40, 41], volcanism: 'Y' },
					{ name: 'Prasinum Bioluminescent Anemone (High metal content world)', type: 'polygon', data: [[472.0, 0.62], [2026.0, 0.62], [2026.0, 9.9], [472.0, 9.9]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", "O (Blue-White) Star", "Herbig Ae/Be Star"], regions: [1, 34, 35, 4, 33, 38, 8, 9, 10, 11, 14, 18, 22], volcanism: 'N' },
					{ name: 'Blatteum Bioluminescent Anemone (High metal content world)', type: 'polygon', data: [[230.0, 0.13], [997.0, 0.13], [997.0, 8.73], [230.0, 8.73]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", "Black Hole", "K (Yellow-Orange giant) Star", null, "O (Blue-White) Star"], regions: [32, 7, 8, 13, 14, 15, 16, 17, 18, 27, 30], volcanism: 'Y' },
					{ name: 'Blatteum Bioluminescent Anemone (Metal-rich body)', type: 'polygon', data: [[1002.0, 0.05], [2523.0, 0.05], [2523.0, 4.24], [1002.0, 4.24]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'Metal-rich body', stars: ["B (Blue-White) Star", "Black Hole", null, "O (Blue-White) Star", "Neutron Star"], regions: [32, 7, 8, 13, 14, 15, 16, 17, 18, 27, 30], volcanism: 'Y' },
					{ name: 'Rubeum Bioluminescent Anemone (High metal content world)', type: 'polygon', data: [[164.0, 0.04], [998.0, 0.04], [998.0, 3.75], [164.0, 3.75]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", "Black Hole", null, "A (Blue-White super giant) Star", "A (Blue-White) Star", "Neutron Star"], regions: [1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 14, 18, 19, 20, 21, 23, 24, 25, 26, 28, 31, 33, 34, 35, 36, 37, 38, 39], volcanism: 'Y' },
					{ name: 'Rubeum Bioluminescent Anemone (Metal-rich body)', type: 'polygon', data: [[1001.0, 0.03], [1782.0, 0.03], [1782.0, 3.83], [1001.0, 3.83]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'Metal-rich body', stars: ["B (Blue-White) Star", "Black Hole", null, "A (Blue-White super giant) Star", "A (Blue-White) Star"], regions: [1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 13, 14, 15, 16, 18, 19, 20, 28, 29, 31, 33, 34, 35, 36], volcanism: 'Y' },
					{ name: 'Puniceum Brain Tree (High metal content world)', type: 'polygon', data: [[129.0, 0.05], [998.0, 0.05], [998.0, 3.46], [129.0, 3.46]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'High metal content world', stars: [null, "F (White) Star", "G (White-Yellow) Star", "T Tauri Star", "A (Blue-White) Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [9, 10, 35], volcanism: 'Y' },
					{ name: 'Roseum Bioluminescent Anemone (High metal content world)', type: 'polygon', data: [[446.0, 0.24], [998.0, 0.24], [998.0, 4.53], [446.0, 4.53]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", "B (Blue-White super giant) Star", null], regions: [1, 2, 3, 4, 5, 6, 9, 10, 14, 18, 19, 23, 24, 25, 31, 32, 33, 34, 35, 36, 37, 38, 39, 41], volcanism: 'Y' },
					{ name: 'Amphora Plant (Metal-rich body)', type: 'polygon', data: [[1000.0, 0.04], [1672.0, 0.04], [1672.0, 2.89], [1000.0, 2.89]], showInLegend: true, marker: { enabled: false }, color: 'red', opacity: opacity, bodyType: 'Metal-rich body', stars: ["A (Blue-White) Star"], regions: [10, 19, 20, 21, 22], volcanism: 'Y' },
					{ name: 'Ostrinum Brain Tree (Metal-rich body)', type: 'polygon', data: [[1000.0, 0.05], [1794.0, 0.05], [1794.0, 2.12], [1000.0, 2.12]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Metal-rich body', stars: ["B (Blue-White) Star", "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [17, 18, 2, 35], volcanism: 'Y' },
					{ name: 'Prasinum Bioluminescent Anemone (Rocky body)', type: 'polygon', data: [[111.0, 0.04], [998.0, 0.04], [998.0, 1.84], [111.0, 1.84]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'Rocky body', stars: ["O (Blue-White) Star", "Herbig Ae/Be Star"], regions: [1, 2, 3, 4, 5, 8, 9, 10, 12, 15, 17, 18, 19, 24, 26, 31, 32, 33, 34, 38], volcanism: 'N' },
					{ name: 'Puniceum Brain Tree (Metal-rich body)', type: 'polygon', data: [[1004.0, 0.05], [1733.0, 0.05], [1733.0, 1.9], [1004.0, 1.9]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Metal-rich body', stars: ["F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [9, 10], volcanism: 'Y' },
					{ name: 'Puniceum Anemone (Icy body)', type: 'polygon', data: [[75.0, 0.17], [679.0, 0.17], [679.0, 2.3], [75.0, 2.3]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'Icy body', stars: ["O (Blue-White) Star", "Wolf-Rayet C Star"], regions: [8, 18, 30], volcanism: 'N' },
					{ name: 'Ostrinum Brain Tree (High metal content world)', type: 'polygon', data: [[204.0, 0.04], [997.0, 0.04], [997.0, 1.64], [204.0, 1.64]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", null, "F (White) Star", "L (Brown dwarf) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "T Tauri Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [17, 18, 2, 35], volcanism: 'Y' },
					{ name: 'Roseum Sinuous Tubers (High metal content world)', type: 'polygon', data: [[201.0, 0.06], [499.0, 0.06], [499.0, 3.01], [201.0, 3.01]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", "Black Hole", "S-type Star", "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "White Dwarf (DC) Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [1, 2, 3, 4, 6, 9, 18], volcanism: 'N' },
					{ name: 'Roseum Brain Tree (High metal content world)', type: 'polygon', data: [[201.0, 0.03], [498.0, 0.03], [498.0, 2.97], [201.0, 2.97]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", "K (Yellow-Orange giant) Star", null, "F (White) Star", "M (Red giant) Star", "L (Brown dwarf) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "T Tauri Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [2, 35, 9, 10, 17, 18], volcanism: 'Y' },
					{ name: 'Prasinum Sinuous Tubers (High metal content world)', type: 'polygon', data: [[229.0, 0.07], [491.0, 0.07], [491.0, 2.62], [229.0, 2.62]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", "M (Red dwarf) Star", "Black Hole", "F (White) Star", "MS-type Star", "White Dwarf (DB) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star", "White Dwarf (DC) Star", "K (Yellow-Orange) Star"], regions: [1, 2, 3, 4, 9], volcanism: 'N' },
					{ name: 'Bark Mound (High metal content world)', type: 'polygon', data: [[200.0, 0.03], [439.0, 0.03], [439.0, 2.71], [200.0, 2.71]], showInLegend: true, marker: { enabled: false }, color: 'brown', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", "M (Red dwarf) Star", "K (Yellow-Orange giant) Star", null, "F (White) Star", "L (Brown dwarf) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "T Tauri Star", "White Dwarf (DC) Star", "Neutron Star", "White Dwarf (DAB) Star", "K (Yellow-Orange) Star"], regions: [2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 25, 32, 33, 34, 35], volcanism: 'N' },
					{ name: 'Albidum Sinuous Tubers (High metal content world)', type: 'polygon', data: [[201.0, 0.05], [487.0, 0.05], [487.0, 2.13], [201.0, 2.13]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [1, 2, 4, 9], volcanism: 'N' },
					{ name: 'Bark Mound (Icy body)', type: 'polygon', data: [[200.0, 0.02], [431.0, 0.02], [431.0, 2.29], [200.0, 2.29]], showInLegend: true, marker: { enabled: false }, color: 'brown', opacity: opacity, bodyType: 'Icy body', stars: ["B (Blue-White) Star", "F (White) Star", "G (White-Yellow) Star", "T Tauri Star", "A (Blue-White) Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [33, 34, 35, 4, 5, 9, 10, 11, 15, 18], volcanism: 'N' },
					{ name: 'Blatteum Sinuous Tubers (High metal content world)', type: 'polygon', data: [[219.0, 0.08], [491.0, 0.08], [491.0, 1.69], [219.0, 1.69]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'High metal content world', stars: ["F (White) Star", "L (Brown dwarf) Star", "A (Blue-White) Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [9, 18], volcanism: 'Y' },
					{ name: 'Violaceum Sinuous Tubers (High metal content world)', type: 'polygon', data: [[219.0, 0.09], [491.0, 0.09], [491.0, 1.62], [219.0, 1.62]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'High metal content world', stars: ["Neutron Star", "M (Red dwarf) Star", "F (White) Star", "L (Brown dwarf) Star"], regions: [9, 18], volcanism: 'Y' },
					{ name: 'Viride Sinuous Tubers (High metal content world)', type: 'polygon', data: [[219.0, 0.09], [491.0, 0.09], [491.0, 1.6], [219.0, 1.6]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'High metal content world', stars: ["M (Red dwarf) Star", "A (Blue-White) Star", "L (Brown dwarf) Star"], regions: [9, 18], volcanism: 'Y' },
					{ name: 'Aureum Brain Tree (High metal content world)', type: 'polygon', data: [[355.0, 0.06], [491.0, 0.06], [491.0, 2.28], [355.0, 2.28]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'High metal content world', stars: ["F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "T Tauri Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [17, 18, 10, 35], volcanism: 'Y' },
					{ name: 'Luteolum Anemone (Rocky body)', type: 'polygon', data: [[201.0, 0.04], [438.0, 0.04], [438.0, 1.28], [201.0, 1.28]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star"], regions: [32, 34, 7, 13, 14, 15, 16, 18, 27, 30], volcanism: 'Y' },
					{ name: 'Lindigoticum Brain Tree (High metal content world)', type: 'polygon', data: [[355.0, 0.2], [478.0, 0.2], [478.0, 2.28], [355.0, 2.28]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'High metal content world', stars: ["G (White-Yellow) Star", "M (Red dwarf) Star", "A (Blue-White) Star", "F (White) Star"], regions: [17, 18, 10, 35], volcanism: 'Y' },
					{ name: 'Bark Mound (Rocky Ice world)', type: 'polygon', data: [[200.0, 0.04], [325.0, 0.04], [325.0, 1.77], [200.0, 1.77]], showInLegend: true, marker: { enabled: false }, color: 'brown', opacity: opacity, bodyType: 'Rocky Ice world', stars: ["B (Blue-White) Star", null, "F (White) Star", "G (White-Yellow) Star", "T Tauri Star", "A (Blue-White) Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [33, 34, 35, 4, 5, 9, 17, 18], volcanism: 'N' },
					{ name: 'Violaceum Sinuous Tubers (Rocky body)', type: 'polygon', data: [[203.0, 0.04], [490.0, 0.04], [490.0, 0.49], [203.0, 0.49]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star", "K (Yellow-Orange) Star"], regions: [4, 6, 9, 10, 19], volcanism: 'N' },
					{ name: 'Lindigoticum Sinuous Tubers (Rocky body)', type: 'polygon', data: [[209.0, 0.04], [490.0, 0.04], [490.0, 0.49], [209.0, 0.49]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star"], regions: [9, 4, 6, 7], volcanism: 'N' },
					{ name: 'Blatteum Sinuous Tubers (Rocky body)', type: 'polygon', data: [[205.0, 0.04], [473.0, 0.04], [473.0, 0.49], [205.0, 0.49]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star", "K (Yellow-Orange) Star"], regions: [4, 6, 7, 9, 10, 19], volcanism: 'N' },
					{ name: 'Roseum Brain Tree (Rocky body)', type: 'polygon', data: [[200.0, 0.04], [499.0, 0.04], [499.0, 0.42], [200.0, 0.42]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "K (Yellow-Orange giant) Star", "White Dwarf (DAB) Star", "C Star", null, "F (White) Star", "L (Brown dwarf) Star", "G (White-Yellow) Star", "O (Blue-White) Star", "A (Blue-White) Star", "T Tauri Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [2, 35, 9, 10, 17, 18], volcanism: 'Y' },
					{ name: 'Bark Mound (Rocky body)', type: 'polygon', data: [[184.0, 0.02], [439.0, 0.02], [439.0, 0.46], [184.0, 0.46]], showInLegend: true, marker: { enabled: false }, color: 'brown', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "B (Blue-White super giant) Star", "Black Hole", "K (Yellow-Orange giant) Star", "S-type Star", "C Star", null, "F (White) Star", "MS-type Star", "M (Red giant) Star", "A (Blue-White super giant) Star", "G (White-Yellow) Star", "O (Blue-White) Star", "A (Blue-White) Star", "T Tauri Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18, 19, 20, 25, 32, 33, 34, 35], volcanism: 'N' },
					{ name: 'Lindigoticum Sinuous Tubers (High metal content world)', type: 'polygon', data: [[219.0, 0.08], [491.0, 0.08], [491.0, 0.41], [219.0, 0.41]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'High metal content world', stars: ["L (Brown dwarf) Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [9, 18], volcanism: 'Y' },
					{ name: 'Aureum Brain Tree (Rocky body)', type: 'polygon', data: [[303.0, 0.04], [486.0, 0.04], [486.0, 0.46], [303.0, 0.46]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "K (Yellow-Orange giant) Star", null, "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [35, 9, 10, 17, 18], volcanism: 'Y' },
					{ name: 'Lividum Brain Tree (Rocky body)', type: 'polygon', data: [[300.0, 0.04], [496.0, 0.04], [496.0, 0.42], [300.0, 0.42]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "K (Yellow-Orange giant) Star", "C Star", null, "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "T Tauri Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [2, 35, 9, 10, 17, 18], volcanism: 'Y' },
					{ name: 'Roseum Sinuous Tubers (Rocky body)', type: 'polygon', data: [[200.0, 0.04], [497.0, 0.04], [497.0, 0.27], [200.0, 0.27]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", null, "F (White) Star", "MS-type Star", "L (Brown dwarf) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [1, 2, 3, 4, 5, 6, 7, 9, 10, 19], volcanism: 'N' },
					{ name: 'Croceum Anemone (Rocky body)', type: 'polygon', data: [[213.0, 0.04], [439.0, 0.04], [439.0, 0.31], [213.0, 0.31]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "A (Blue-White super giant) Star", "A (Blue-White) Star"], regions: [18, 14, 15], volcanism: 'Y' },
					{ name: 'Crystalline Shards (High metal content world)', type: 'polygon', data: [[191.0, 0.07], [230.0, 0.07], [230.0, 1.37], [191.0, 1.37]], showInLegend: true, marker: { enabled: false }, color: 'green', opacity: opacity, bodyType: 'High metal content world', stars: ["B (Blue-White) Star", null, "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star", "K (Yellow-Orange) Star"], regions: [34, 36, 38, 39, 40, 41, 24, 29, 31], volcanism: 'Y' },
					{ name: 'Prasinum Sinuous Tubers (Rocky body)', type: 'polygon', data: [[208.0, 0.04], [488.0, 0.04], [488.0, 0.22], [208.0, 0.22]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'Rocky body', stars: [null, "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star", "K (Yellow-Orange) Star"], regions: [1, 2, 3, 5, 9], volcanism: 'N' },
					{ name: 'Viride Brain Tree (Rocky Ice world)', type: 'polygon', data: [[100.0, 0.04], [242.0, 0.04], [242.0, 0.39], [100.0, 0.39]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Rocky Ice world', stars: [null, "F (White) Star", "G (White-Yellow) Star", "T Tauri Star", "Neutron Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [35, 9, 10, 17, 18], volcanism: 'Y' },
					{ name: 'Roseum Anemone (Rocky body)', type: 'polygon', data: [[274.0, 0.05], [433.0, 0.05], [433.0, 0.32], [274.0, 0.32]], showInLegend: true, marker: { enabled: false }, color: 'orange', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White super giant) Star", "B (Blue-White) Star"], regions: [18, 14, 15], volcanism: 'Y' },
					{ name: 'Albidum Sinuous Tubers (Rocky body)', type: 'polygon', data: [[206.0, 0.04], [424.0, 0.04], [424.0, 0.22], [206.0, 0.22]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'Rocky body', stars: [null, "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star", "K (Yellow-Orange) Star"], regions: [1, 2, 5, 9], volcanism: 'N' },
					{ name: 'Gypseeum Brain Tree (Rocky body)', type: 'polygon', data: [[200.0, 0.04], [329.0, 0.04], [329.0, 0.29], [200.0, 0.29]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Rocky body', stars: ["F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "M (Red dwarf) Star", "K (Yellow-Orange) Star"], regions: [2, 35, 9, 10, 17, 18], volcanism: 'Y' },
					{ name: 'Crystalline Shards (Rocky body)', type: 'polygon', data: [[90.0, 0.04], [247.0, 0.04], [247.0, 0.22], [90.0, 0.22]], showInLegend: true, marker: { enabled: false }, color: 'green', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "K (Yellow-Orange) Star"], regions: [34, 36, 37, 38, 40, 41, 42, 14, 21, 22, 23, 24, 25, 26, 27, 29, 31], volcanism: 'Y' },
					{ name: 'Crystalline Shards (Icy body)', type: 'polygon', data: [[27.0, 0.02], [133.0, 0.02], [133.0, 0.19], [27.0, 0.19]], showInLegend: true, marker: { enabled: false }, color: 'green', opacity: opacity, bodyType: 'Icy body', stars: ["Black Hole", null, "F (White) Star", "G (White-Yellow) Star", "A (Blue-White) Star", "Neutron Star", "K (Yellow-Orange) Star"], regions: [34, 36, 37, 38, 40, 41, 42, 14, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31], volcanism: 'Y' },
					{ name: 'Roseum Brain Tree (Icy body)', type: 'polygon', data: [[200.0, 0.03], [247.0, 0.03], [247.0, 0.26], [200.0, 0.26]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Icy body', stars: ["L (Brown dwarf) Star", "M (Red dwarf) Star", "T Tauri Star", "K (Yellow-Orange) Star"], regions: [35, 18, 10], volcanism: 'Y' },
					{ name: 'Lindigoticum Brain Tree (Rocky body)', type: 'polygon', data: [[370.0, 0.05], [499.0, 0.05], [499.0, 0.13], [370.0, 0.13]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Rocky body', stars: ["G (White-Yellow) Star", "F (White) Star", "A (Blue-White) Star"], regions: [10, 9, 2, 18], volcanism: 'Y' },
					{ name: 'Crystalline Shards (Rocky Ice world)', type: 'polygon', data: [[98.0, 0.05], [168.0, 0.05], [168.0, 0.16], [98.0, 0.16]], showInLegend: true, marker: { enabled: false }, color: 'green', opacity: opacity, bodyType: 'Rocky Ice world', stars: ["G (White-Yellow) Star", "F (White) Star", "K (Yellow-Orange) Star"], regions: [34, 37, 41, 24, 27, 31], volcanism: 'Y' },
					{ name: 'Roseum Brain Tree (Rocky Ice world)', type: 'polygon', data: [[200.0, 0.08], [242.0, 0.08], [242.0, 0.26], [200.0, 0.26]], showInLegend: true, marker: { enabled: false }, color: 'blue', opacity: opacity, bodyType: 'Rocky Ice world', stars: ["M (Red dwarf) Star", "T Tauri Star", "L (Brown dwarf) Star"], regions: [18], volcanism: 'Y' },
					{ name: 'Viride Sinuous Tubers (Rocky body)', type: 'polygon', data: [[327.0, 0.08], [429.0, 0.08], [429.0, 0.14], [327.0, 0.14]], showInLegend: true, marker: { enabled: false }, color: 'purple', opacity: opacity, bodyType: 'Rocky body', stars: ["B (Blue-White) Star", "A (Blue-White) Star", "K (Yellow-Orange) Star"], regions: [9, 4], volcanism: 'Y' },
					{ name: 'Bark Mound (Metal-rich body)', type: 'polygon', data: [[1712.0, 3.17], [1712.0, 3.17], [1712.0, 3.18], [1712.0, 3.18]], showInLegend: true, marker: { enabled: false }, color: 'brown', opacity: opacity, bodyType: 'Metal-rich body', stars: ["O (Blue-White) Star"], regions: [33], volcanism: 'Y' },


				]



				var biolist = []

				function get_signals(body) {
					retval = ''
					window.signals.forEach(function (signal) {
						console.log('Signals ' + signal.body + '  ' + body)
						if (signal.body.trim() == body.trim() & signal.type == 'Biology') {
							console.log('Found Signals ' + signal.body + '  ' + body)
							retval = '<br>' + signal.count + ' Biological Signals Found'
						}
					});
					return retval
				}

				function get_entries(body) {
					bodyentries = {}
					window.entries.forEach(function (entry) {

						if (entry.body.trim() == body.trim() & entry.hud_category == 'Biology') {
							bodyentries[entry.name] = entry.english_name
						}
					});
					var retval = "<br>"
					for (var key in bodyentries) {
						// check if the property/key is defined in the object itself, not in parent
						if (bodyentries.hasOwnProperty(key)) {
							console.log(bodyentries[key]);
							retval = retval + bodyentries[key] + '<br>'
						}
					}
					return retval
				}

				function match_conditions(region, primary, planet, codex) {
					temp = planet.data[0][0];
					gravity = planet.data[0][1]
					ming = codex.data[0][1]
					maxg = codex.data[2][1]
					mint = codex.data[0][0]
					maxt = codex.data[1][0]

					if (codex.volcanism == 'N') {
						volcanismmatch = true
					} else {
						if (planet.volcanism == 'No volcanism') {
							volcanismmatch = false
						} else {
							volcanismmatch = true
						}
					}

					bodymatch = (codex.bodyType == planet.bodyType)
					starmatch = (codex.stars.includes(primary))
					gravitymatch = (ming < gravity & maxg > gravity)
					tempmatch = (mint < temp & maxt > temp)
					regionmatch = (codex.regions.includes(region))

					return (bodymatch & starmatch & gravitymatch & tempmatch & regionmatch & volcanismmatch)
				}

				planets.forEach((planet, i, a) => {
					temp = planet.data[0][0];
					gravity = planet.data[0][1]

					var newarray = biostats.filter(element => (match_conditions(region, primary, planet, element)))
					biolist = biolist.concat(newarray).unique();
				});

				seriesdata = biolist.concat(planets)

				Highcharts.chart('container', {
					chart: {
						type: 'scatter',
						zoomType: 'xy'
					},
					title: {
						text: 'Gravity Vs Temperature Ranges for Biological Signals'
					},
					subtitle: {
						text: "<b>System:</b> " + system + " <b>Region:</b> " + regionname + " <b>Primary Star:</b> " + primary
					},
					xAxis: {
						title: {
							enabled: true,
							text: 'Surface Temperature (K)'
						},
						startOnTick: true,
						endOnTick: true,
						showLastLabel: true
					},
					yAxis: {
						title: {
							text: 'Gravity (G)'
						}
					},
					tooltip: {
						formatter: function () {
							if (this.series.type == 'polygon') {
								return '<b>' + this.series.name + '</b>' +
									'<br>Temperature Range: ' +
									this.series.options.data[0][0] +
									' - ' +
									this.series.options.data[1][0] + ' (K)<br>Gravity Range: ' +
									this.series.options.data[0][1] +
									' - ' +
									this.series.options.data[2][1] +
									' (G)'
							} else {
								planet = this.series.name.split("-", 1)[0].replace("Planet ", "").trim()
								console.log(planet)

								return '<b>' + this.series.name + '</b><br>Temperature: ' + this.point.x + ' (K)<br>Gravity: ' + this.point.y + ' (G)' + get_entries(planet) + get_signals(planet)

							}

							//return this.series.name + '<br>Oh come on' + this.series.options.data[0][0]
						}
						//headerFormat: '<b>{series.name}</b><br>{series.xData[0]}',
						//pointFormat: 'Min Temperature {this.data[0][0]} K</b><br>Gravity {series.type} G'
					},
					plotOptions: {
						polygon: {

							events: {
								click: function (e) {
									var polygon = e.currentTarget;
									this.showInLegend = true
									this.options.showInLegend = true
									this.chart.legend.render()
									this.hide()

								},
								/*legendItemClick: function () {
									//var visibility = this.visible ? 'visible' : 'hidden';
		
									this.showInLegend = false
									this.render()
								}*/
							}
						},
						scatter: {
							marker: {
								radius: 5,
								states: {
									hover: {
										enabled: true,
										lineColor: 'rgb(100,100,100)'
									}
								}
							},
							states: {
								hover: {
									marker: {
										enabled: false
									}
								}
							},
							tooltip: {
								headerFormat: '<b>{series.name}</b><br>',
								pointFormat: 'Temperature {point.x} K</b><br>Gravity {point.y} G'
							}
						}
					},
					/*
			"High metal content world":
				{"ming": 0.07489301192, "maxg": 1.361246451, "mint": 191, "maxt": 230},
			"Icy body": 
				{"ming": 0.02514043344, "maxg": 0.1830008426, "mint": 27, "maxt": 133,"volcanism": True},
			"Rocky Ice world": 
				{"ming": 0.05009637503, "maxg": 0.1541432719, "mint": 98, "maxt": 168,"volcanism": True},
			"Rocky body": 
				{"ming": 0.04557216926, "maxg": 0.2123876965, "mint": 90, "maxt": 247,"volcanism": True},
					*/
					series: seriesdata
				});

			}
		</script>
		<div style="overflow: visible">
			<figure class="highcharts-figure">
				<div id="container"></div>
				<p class="highcharts-description">
				</p>
			</figure>
			<p>
			<div id="results-table" style="overflow: visible">&nbsp;</div>
			</p>
			<p>
			<div id="entries-table">&nbsp;</div>
		</div>
		<br />

		<br />
		<br />
		<br />
		<br />
		<br />
		<br />
		</P>

	</div><!-- /.container -->

	<script>
		// Instantiate the Bloodhound suggestion engine
		const movies = new Bloodhound({
			datumTokenizer: datum => Bloodhound.tokenizers.whitespace(datum.value),
			queryTokenizer: Bloodhound.tokenizers.whitespace,
			remote: {
				dataType: 'jsonp',
				//url: 'https://us-central1-canonn-api-236217.cloudfunctions.net/systems?q=%QUERY',
				//url: 'https://spansh.co.uk/api/systems/field_values/system_names?q=%QUERY',
				url: 'https://backend3.spansh.co.uk:3000/api/systems/field_values/system_names?q=%QUERY',
				// Map the remote source JSON array to a JavaScript object array
				filter: movies => $.map(movies.results, function (movie) {
					//console.log(movie)
					return { value: movie }
				})
			}
		});

		// Initialize the Bloodhound suggestion engine
		movies.initialize();

		// Instantiate the Typeahead UI
		$('.typeahead').typeahead(null, {
			displayKey: 'value',
			minLength: 3,
			source: movies.ttAdapter()

		});
	</script>
	</div>
	<!-- Footer -->
	<footer id="footer">
		<ul class="icons">
			<li><a href="http://twitter.com/CanonnResearch" class="icon brands fa-twitter"><span
						class="label">Twitter</span></a></li>
			<li><a href="https://github.com/canonn-science/Aurvandil/blob/master/README.md"
					class="icon brands fa-github"><span class="label">GitHub</span></a></li>
		</ul>
		<ul class="copyright">
			<li>&copy; Canonn Interstellar Research.</li>
			<li>Credits: <a href="http://html5up.net">HTML5 UP</a></li>
		</ul>
	</footer>

	<!-- Scripts -->
	<script src="assets/js/main.js"></script>

</body>

</html>